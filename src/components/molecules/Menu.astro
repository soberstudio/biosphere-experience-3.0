---
import { siteInfo } from '../../data/SiteData';
import YoutubeIcon from '../../assets/icons/youtube.svg';
import InstagramIcon from '../../assets/icons/instagram.svg';
import LinkedInIcon from '../../assets/icons/linkedin.svg';
import Email from '../../assets/icons/email.svg';
---

<div id="menu" class="menu">
  <nav class="absolute flex flex-col top-14 rounded-xl right-3 md:right-6 border bg-bg border-neutral-900 items-center justify-center text-sm">
    <ul class="flex flex-col gap-8  py-10 px-12 uppercase [&_a]:no-underline">
      <li><a href="/historique" class="text-gray-200 hover:text-white">L'histoire biosphère</a></li>
      <li><a href="/biosphere-plateforme" class="text-gray-200 hover:text-white">Biosphère plateforme</a></li>
      <li><a href="/biosphere-du-desert" class="text-gray-200 hover:text-white">Biosphère du désert</a></li>
      <li><a href="/biosphere-urbaine" class="text-gray-200 hover:text-white">Biosphère urbaine</a></li>
      <li><a href="/equipe-partenaires" class="text-gray-200 hover:text-white">Équipe et partenaires</a></li>
      <li><a href="/site-eco-concu" class="text-gray-200 hover:text-white">Site web éco-conçu</a></li>
    </ul>
    <ul class="flex gap-6 w-full justify-between p-8 border-t border-neutral-900 social-links">
        <li>
            <a href={`mailto:${siteInfo.email}`}>
              <Email width={25} height={25} fill="white"/>
            </a>
        </li>
      <li>
        <a href={siteInfo.social.youtube} target="_blank" rel="noopener" aria-label="YouTube">
          <YoutubeIcon width={25} height={25} fill="white"/>
        </a>
      </li>
      <li>
        <a href={siteInfo.social.instagram} target="_blank" rel="noopener" aria-label="Instagram">
          <InstagramIcon width={25} height={25} fill="white"/>
        </a>
      </li>
      <li>
        <a href={siteInfo.social.linkedin} target="_blank" rel="noopener" aria-label="LinkedIn">
          <LinkedInIcon width={25} height={25} fill="white"/>
        </a>
      </li>
    </ul>
  </nav>
</div>

<script>
  const menuButton = document.getElementById('menu-toggle') as HTMLButtonElement;
  const menu = document.getElementById('menu') as HTMLDivElement;

  function closeMenu() {
    menuButton?.setAttribute('aria-expanded', 'false');
    menu?.classList.remove('open');
  }

  menuButton?.addEventListener('click', () => {
    const isExpanded = menuButton.getAttribute('aria-expanded') === 'true';
    menuButton.setAttribute('aria-expanded', String(!isExpanded));
    isExpanded ? menu?.classList.remove('open') : menu?.classList.add('open');
  });

  // Close menu on: nav links, Escape key, or outside click
  menu?.querySelectorAll('a').forEach(link => link.addEventListener('click', closeMenu));
  document.addEventListener('keydown', (e) => e.key === 'Escape' && menuButton?.getAttribute('aria-expanded') === 'true' && closeMenu());
  menu?.addEventListener('click', (e) => e.target === menu && closeMenu());
</script>

<style>
  .menu {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.65);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
    z-index: 998;
  }

  .menu.open {
    opacity: 1;
    pointer-events: auto;
  }
</style>
